{"version":3,"file":"index.js","names":["semgrepSeverity: string","finding: SemgrepFinding","semgrepResult: SemgrepResult","scanPath: string","config: string","targetPath: string","verbose: boolean","data: Buffer","result: ScanResult","options: CliOptions"],"sources":["../src/types.ts","../src/index.ts"],"sourcesContent":["export interface SemgrepResult {\n  results: SemgrepFinding[];\n  errors: SemgrepError[];\n  version: string;\n}\n\nexport interface SemgrepFinding {\n  check_id: string;\n  path: string;\n  start: { line: number; col: number };\n  end: { line: number; col: number };\n  extra: {\n    message: string;\n    severity: string;\n    metadata: {\n      cwe?: string[];\n      owasp?: string[];\n      confidence?: string;\n      category?: string;\n      subcategory?: string[];\n      technology?: string[];\n      references?: string[];\n    };\n    lines: string;\n    fix?: string;\n  };\n}\n\nexport interface SemgrepError {\n  message: string;\n  level: string;\n}\n\nexport interface SastFinding {\n  id: string;\n  severity: 'critical' | 'high' | 'medium' | 'low' | 'info';\n  message: string;\n  file: string;\n  line: number;\n  endLine: number;\n  code: string;\n  cwes: string[];\n  owasp: string[];\n  category: string;\n  fix?: string;\n  references: string[];\n}\n\nexport interface ScanResult {\n  tool: string;\n  version: string;\n  scanPath: string;\n  scanDate: string;\n  config: string;\n  findings: SastFinding[];\n  summary: {\n    total: number;\n    critical: number;\n    high: number;\n    medium: number;\n    low: number;\n    info: number;\n  };\n}\n\nexport interface CliOptions {\n  path: string;\n  config: string;\n  json: boolean;\n  check: boolean;\n  listConfigs: boolean;\n  verbose: boolean;\n}\n\nexport const CONFIGS = {\n  auto: 'auto',\n  'security-audit': 'p/security-audit',\n  'owasp-top-ten': 'p/owasp-top-ten',\n  'cwe-top-25': 'p/cwe-top-25',\n  default: 'p/default',\n  javascript: 'p/javascript',\n  typescript: 'p/typescript',\n  python: 'p/python',\n  golang: 'p/golang',\n  java: 'p/java',\n  ruby: 'p/ruby',\n} as const;\n\nexport type ConfigName = keyof typeof CONFIGS;\n","#!/usr/bin/env node\n\nimport { spawn, spawnSync } from \"node:child_process\";\nimport { parseArgs } from \"node:util\";\nimport type {\n  CliOptions,\n  SastFinding,\n  ScanResult,\n  SemgrepFinding,\n  SemgrepResult,\n} from \"./types.js\";\nimport { CONFIGS, type ConfigName } from \"./types.js\";\n\nfunction checkSemgrepInstalled(): boolean {\n  try {\n    const result = spawnSync(\"semgrep\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    return result.status === 0;\n  } catch {\n    return false;\n  }\n}\n\nfunction getSemgrepVersion(): string {\n  try {\n    const result = spawnSync(\"semgrep\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    return result.stdout?.trim() || \"unknown\";\n  } catch {\n    return \"unknown\";\n  }\n}\n\nfunction mapSeverity(\n  semgrepSeverity: string\n): \"critical\" | \"high\" | \"medium\" | \"low\" | \"info\" {\n  const severity = semgrepSeverity.toUpperCase();\n  switch (severity) {\n    case \"ERROR\":\n      return \"high\";\n    case \"WARNING\":\n      return \"medium\";\n    case \"INFO\":\n      return \"low\";\n    default:\n      return \"info\";\n  }\n}\n\nfunction transformFinding(finding: SemgrepFinding): SastFinding {\n  const metadata = finding.extra.metadata || {};\n\n  // Check if it's a critical severity based on CWE or category\n  let severity = mapSeverity(finding.extra.severity);\n  const criticalCWEs = [\"CWE-89\", \"CWE-78\", \"CWE-94\", \"CWE-502\"];\n  if (metadata.cwe?.some((cwe) => criticalCWEs.includes(cwe))) {\n    severity = \"critical\";\n  }\n\n  return {\n    id: finding.check_id,\n    severity,\n    message: finding.extra.message,\n    file: finding.path,\n    line: finding.start.line,\n    endLine: finding.end.line,\n    code: finding.extra.lines,\n    cwes: metadata.cwe || [],\n    owasp: metadata.owasp || [],\n    category: metadata.category || \"security\",\n    fix: finding.extra.fix,\n    references: metadata.references || [],\n  };\n}\n\nfunction transformResults(\n  semgrepResult: SemgrepResult,\n  scanPath: string,\n  config: string\n): ScanResult {\n  const findings = semgrepResult.results.map(transformFinding);\n\n  const summary = {\n    total: findings.length,\n    critical: findings.filter((f) => f.severity === \"critical\").length,\n    high: findings.filter((f) => f.severity === \"high\").length,\n    medium: findings.filter((f) => f.severity === \"medium\").length,\n    low: findings.filter((f) => f.severity === \"low\").length,\n    info: findings.filter((f) => f.severity === \"info\").length,\n  };\n\n  return {\n    tool: \"semgrep\",\n    version: semgrepResult.version || getSemgrepVersion(),\n    scanPath,\n    scanDate: new Date().toISOString(),\n    config,\n    findings,\n    summary,\n  };\n}\n\nasync function runSemgrep(\n  targetPath: string,\n  config: string,\n  verbose: boolean\n): Promise<SemgrepResult> {\n  return new Promise((resolve, reject) => {\n    const args = [\"scan\", \"--config\", config, \"--json\", targetPath];\n\n    if (verbose) {\n      console.error(`Running: semgrep ${args.join(\" \")}`);\n    }\n\n    const proc = spawn(\"semgrep\", args, {\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n\n    let stdout = \"\";\n    let stderr = \"\";\n\n    proc.stdout.on(\"data\", (data: Buffer) => {\n      stdout += data.toString();\n    });\n\n    proc.stderr.on(\"data\", (data: Buffer) => {\n      stderr += data.toString();\n    });\n\n    proc.on(\"close\", (code) => {\n      // Semgrep exit codes:\n      // 0 = no findings\n      // 1 = findings detected\n      // Other = error\n      if (code === 0 || code === 1) {\n        try {\n          const result = JSON.parse(stdout) as SemgrepResult;\n          resolve(result);\n        } catch (e) {\n          reject(new Error(`Failed to parse semgrep output: ${e}`));\n        }\n      } else {\n        reject(\n          new Error(`Semgrep exited with code ${code}: ${stderr || stdout}`)\n        );\n      }\n    });\n\n    proc.on(\"error\", (err) => {\n      reject(new Error(`Failed to spawn semgrep: ${err.message}`));\n    });\n  });\n}\n\nfunction printTextReport(result: ScanResult): void {\n  console.log(\"\\n=== SAST Scan Report ===\\n\");\n  console.log(`Tool: ${result.tool} (${result.version})`);\n  console.log(`Scan Path: ${result.scanPath}`);\n  console.log(`Config: ${result.config}`);\n  console.log(`Date: ${result.scanDate}`);\n  console.log(\"\\n--- Summary ---\");\n  console.log(`Total: ${result.summary.total}`);\n  console.log(`  Critical: ${result.summary.critical}`);\n  console.log(`  High: ${result.summary.high}`);\n  console.log(`  Medium: ${result.summary.medium}`);\n  console.log(`  Low: ${result.summary.low}`);\n  console.log(`  Info: ${result.summary.info}`);\n\n  if (result.findings.length > 0) {\n    console.log(\"\\n--- Findings ---\\n\");\n\n    // Sort by severity\n    const severityOrder = { critical: 0, high: 1, medium: 2, low: 3, info: 4 };\n    const sorted = [...result.findings].sort(\n      (a, b) => severityOrder[a.severity] - severityOrder[b.severity]\n    );\n\n    for (const finding of sorted) {\n      console.log(\n        `[${finding.severity.toUpperCase()}] ${finding.id}`\n      );\n      console.log(`  File: ${finding.file}:${finding.line}`);\n      console.log(`  Message: ${finding.message}`);\n      if (finding.cwes.length > 0) {\n        console.log(`  CWEs: ${finding.cwes.join(\", \")}`);\n      }\n      if (finding.owasp.length > 0) {\n        console.log(`  OWASP: ${finding.owasp.join(\", \")}`);\n      }\n      if (finding.fix) {\n        console.log(`  Fix: ${finding.fix}`);\n      }\n      console.log(`  Code: ${finding.code.trim()}`);\n      console.log(\"\");\n    }\n  } else {\n    console.log(\"\\nNo security issues found.\");\n  }\n}\n\nfunction printListConfigs(): void {\n  console.log(\"\\nAvailable configurations:\\n\");\n  for (const [name, value] of Object.entries(CONFIGS)) {\n    console.log(`  ${name.padEnd(20)} -> ${value}`);\n  }\n  console.log(\"\\nUsage: sast-runner <path> --config <config-name>\");\n  console.log(\"Example: sast-runner . --config security-audit\");\n}\n\nfunction printHelp(): void {\n  console.log(`\nsast-runner - Static Application Security Testing with Semgrep\n\nUsage:\n  sast-runner <path> [options]\n  sast-runner --check\n  sast-runner --list-configs\n\nOptions:\n  --config, -c <name>   Configuration to use (default: auto)\n  --json, -j            Output as JSON\n  --check               Check if semgrep is installed\n  --list-configs        List available configurations\n  --verbose, -v         Verbose output\n  --help, -h            Show this help\n\nExamples:\n  sast-runner .                          # Scan current directory\n  sast-runner src/ --config security-audit\n  sast-runner . --json                   # JSON output\n  sast-runner --check                    # Check installation\n`);\n}\n\nasync function main(): Promise<void> {\n  const { values, positionals } = parseArgs({\n    allowPositionals: true,\n    options: {\n      config: { type: \"string\", short: \"c\", default: \"auto\" },\n      json: { type: \"boolean\", short: \"j\", default: false },\n      check: { type: \"boolean\", default: false },\n      \"list-configs\": { type: \"boolean\", default: false },\n      verbose: { type: \"boolean\", short: \"v\", default: false },\n      help: { type: \"boolean\", short: \"h\", default: false },\n    },\n  });\n\n  if (values.help) {\n    printHelp();\n    process.exit(0);\n  }\n\n  if (values[\"list-configs\"]) {\n    printListConfigs();\n    process.exit(0);\n  }\n\n  if (values.check) {\n    if (checkSemgrepInstalled()) {\n      const version = getSemgrepVersion();\n      console.log(`Semgrep is installed (version: ${version})`);\n      process.exit(0);\n    } else {\n      console.error(\"Semgrep is not installed.\");\n      console.error(\"\\nInstall with:\");\n      console.error(\"  pip install semgrep\");\n      console.error(\"  brew install semgrep\");\n      console.error(\"  docker pull semgrep/semgrep\");\n      process.exit(2);\n    }\n  }\n\n  const targetPath = positionals[0];\n  if (!targetPath) {\n    console.error(\"Error: No target path specified.\");\n    console.error(\"Usage: sast-runner <path> [options]\");\n    process.exit(2);\n  }\n\n  if (!checkSemgrepInstalled()) {\n    console.error(\"Error: Semgrep is not installed.\");\n    console.error(\"Run 'sast-runner --check' for installation instructions.\");\n    process.exit(2);\n  }\n\n  const configName = (values.config || \"auto\") as ConfigName;\n  const configValue = CONFIGS[configName] || configName;\n\n  const options: CliOptions = {\n    path: targetPath,\n    config: configValue,\n    json: values.json || false,\n    check: values.check || false,\n    listConfigs: values[\"list-configs\"] || false,\n    verbose: values.verbose || false,\n  };\n\n  try {\n    const semgrepResult = await runSemgrep(\n      options.path,\n      options.config,\n      options.verbose\n    );\n    const result = transformResults(semgrepResult, options.path, configName);\n\n    if (options.json) {\n      console.log(JSON.stringify(result, null, 2));\n    } else {\n      printTextReport(result);\n    }\n\n    // Exit with 1 if findings were detected\n    if (result.summary.total > 0) {\n      process.exit(1);\n    }\n    process.exit(0);\n  } catch (error) {\n    console.error(\n      `Error: ${error instanceof Error ? error.message : String(error)}`\n    );\n    process.exit(2);\n  }\n}\n\nmain();\n"],"mappings":"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"}