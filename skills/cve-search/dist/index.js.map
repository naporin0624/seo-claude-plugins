{"version":3,"file":"index.js","names":["args: string[]","options: CLIOptions","apiKey: string | null","options: CLIOptions","headers: Record<string, string>","severity: Severity","estimates: Record<Severity, string>","SEVERITY_ORDER: Record<Severity, number>","vuln: NVDVulnerability","cves: FormattedCVE[]","totalResults: number","summary: SearchSummary","lines: string[]","cve: FormattedCVE"],"sources":["../src/cli.ts","../src/api.ts","../src/formatter.ts","../src/index.ts"],"sourcesContent":["/**\n * CLI for CVE Search\n */\n\nimport type { CLIOptions, Severity } from './types.js';\n\nexport function parseArgs(args: string[]): CLIOptions | null {\n  const options: CLIOptions = {\n    keyword: null,\n    cveId: null,\n    cweId: null,\n    severity: null,\n    days: null,\n    limit: 10,\n    apiKey: null,\n    json: false,\n  };\n\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n\n    switch (arg) {\n      case '--keyword':\n      case '-k':\n        options.keyword = args[++i] || null;\n        break;\n      case '--cve':\n        options.cveId = args[++i] || null;\n        break;\n      case '--cwe':\n        options.cweId = args[++i] || null;\n        break;\n      case '--severity':\n      case '-s': {\n        const sev = args[++i]?.toUpperCase();\n        if (sev && ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW'].includes(sev)) {\n          options.severity = sev as Severity;\n        }\n        break;\n      }\n      case '--days':\n      case '-d': {\n        const days = parseInt(args[++i], 10);\n        if (!isNaN(days) && days > 0) {\n          options.days = days;\n        }\n        break;\n      }\n      case '--limit':\n      case '-l': {\n        const limit = parseInt(args[++i], 10);\n        if (!isNaN(limit) && limit > 0) {\n          options.limit = limit;\n        }\n        break;\n      }\n      case '--api-key':\n        options.apiKey = args[++i] || null;\n        break;\n      case '--json':\n        options.json = true;\n        break;\n      case '--help':\n      case '-h':\n        printUsage();\n        return null;\n    }\n  }\n\n  return options;\n}\n\nexport function validateOptions(options: CLIOptions): string | null {\n  if (!options.keyword && !options.cveId && !options.cweId) {\n    return 'At least one of --keyword, --cve, or --cwe is required';\n  }\n  return null;\n}\n\nfunction printUsage(): void {\n  console.log(`\nCVE Search - NVD API 2.0 Client\n\nUsage:\n  npx cve-search [options]\n\nOptions:\n  --keyword, -k <term>    Search by keyword (software name, vendor)\n  --cve <id>              Search by specific CVE ID (e.g., CVE-2021-44228)\n  --cwe <id>              Filter by CWE ID (e.g., CWE-79)\n  --severity, -s <level>  Filter by severity (CRITICAL, HIGH, MEDIUM, LOW)\n  --days, -d <n>          Published in last N days\n  --limit, -l <n>         Max results (default: 10)\n  --api-key <key>         NVD API key (or set NVD_API_KEY env var)\n  --json                  Output as JSON\n  --help, -h              Show this help\n\nExamples:\n  npx cve-search --keyword \"jquery\"\n  npx cve-search --cve \"CVE-2021-44228\"\n  npx cve-search --cwe \"CWE-89\" --severity \"CRITICAL\"\n  npx cve-search --keyword \"apache\" --days 30\n  npx cve-search --keyword \"react\" --json\n`);\n}\n","/**\n * NVD API 2.0 Client\n * Rate limit: 5 requests/30s (public), 50 requests/30s (with API key)\n */\n\nimport type { CLIOptions, NVDResponse, Severity } from './types.js';\n\nconst NVD_API_BASE = 'https://services.nvd.nist.gov/rest/json/cves/2.0';\n\nexport class NVDClient {\n  private apiKey: string | null;\n\n  constructor(apiKey: string | null = null) {\n    this.apiKey = apiKey || process.env.NVD_API_KEY || null;\n  }\n\n  async search(options: CLIOptions): Promise<NVDResponse> {\n    const params = new URLSearchParams();\n\n    if (options.keyword) {\n      params.set('keywordSearch', options.keyword);\n    }\n\n    if (options.cveId) {\n      params.set('cveId', options.cveId);\n    }\n\n    if (options.cweId) {\n      // Normalize CWE ID format\n      const cweId = options.cweId.replace(/^CWE-/i, '');\n      params.set('cweId', `CWE-${cweId}`);\n    }\n\n    if (options.severity) {\n      params.set('cvssV3Severity', options.severity);\n    }\n\n    if (options.days) {\n      const endDate = new Date();\n      const startDate = new Date();\n      startDate.setDate(startDate.getDate() - options.days);\n\n      params.set('pubStartDate', startDate.toISOString());\n      params.set('pubEndDate', endDate.toISOString());\n    }\n\n    params.set('resultsPerPage', String(options.limit));\n\n    const url = `${NVD_API_BASE}?${params.toString()}`;\n\n    const headers: Record<string, string> = {\n      Accept: 'application/json',\n    };\n\n    if (this.apiKey) {\n      headers.apiKey = this.apiKey;\n    }\n\n    try {\n      const response = await fetch(url, { headers });\n\n      if (!response.ok) {\n        if (response.status === 403) {\n          throw new Error('Rate limit exceeded. Wait 30 seconds and try again.');\n        }\n        throw new Error(`API error: ${response.status} ${response.statusText}`);\n      }\n\n      return (await response.json()) as NVDResponse;\n    } catch (error) {\n      if (error instanceof Error && error.message.includes('fetch')) {\n        throw new Error('Network error. Check your internet connection.');\n      }\n      throw error;\n    }\n  }\n}\n\n// Bounty estimate based on severity\nexport function getBountyEstimate(severity: Severity): string {\n  const estimates: Record<Severity, string> = {\n    CRITICAL: '$5,000 - $50,000+',\n    HIGH: '$2,000 - $10,000',\n    MEDIUM: '$500 - $3,000',\n    LOW: '$100 - $500',\n    UNKNOWN: 'Varies',\n  };\n  return estimates[severity];\n}\n","/**\n * CVE Formatter\n * Converts NVD API responses to formatted output\n */\n\nimport type {\n  NVDVulnerability,\n  FormattedCVE,\n  Severity,\n  SearchSummary,\n} from './types.js';\nimport { getBountyEstimate } from './api.js';\n\nconst SEVERITY_ORDER: Record<Severity, number> = {\n  CRITICAL: 0,\n  HIGH: 1,\n  MEDIUM: 2,\n  LOW: 3,\n  UNKNOWN: 4,\n};\n\nexport function formatCVE(vuln: NVDVulnerability): FormattedCVE {\n  const cve = vuln.cve;\n\n  // Get English description\n  const descObj = cve.descriptions?.find((d) => d.lang === 'en');\n  const description = descObj?.value || 'No description available';\n\n  // Get CVSS v3.1 metrics (prefer v3.1, fallback to v3.0)\n  const cvssV31 = cve.metrics?.cvssMetricV31?.[0];\n  const cvssV30 = cve.metrics?.cvssMetricV30?.[0];\n  const cvss = cvssV31 || cvssV30;\n\n  const severity = (cvss?.cvssData?.baseSeverity || 'UNKNOWN') as Severity;\n  const score = cvss?.cvssData?.baseScore ?? 'N/A';\n  const attackVector = cvss?.cvssData?.attackVector || 'UNKNOWN';\n  const attackComplexity = cvss?.cvssData?.attackComplexity || 'UNKNOWN';\n  const privilegesRequired = cvss?.cvssData?.privilegesRequired || 'UNKNOWN';\n  const userInteraction = cvss?.cvssData?.userInteraction || 'UNKNOWN';\n\n  // Get CWEs\n  const cwes =\n    cve.weaknesses\n      ?.flatMap(\n        (w) => w.description?.filter((d) => d.lang === 'en').map((d) => d.value)\n      )\n      .filter((v): v is string => Boolean(v)) || [];\n\n  // Get references (first 5)\n  const references = cve.references?.slice(0, 5).map((r) => r.url) || [];\n\n  // Check for exploit tags\n  const hasExploit =\n    cve.references?.some((r) =>\n      r.tags?.some((t) => t.toLowerCase().includes('exploit'))\n    ) || false;\n\n  return {\n    id: cve.id,\n    description:\n      description.substring(0, 500) + (description.length > 500 ? '...' : ''),\n    severity,\n    score,\n    bountyEstimate: getBountyEstimate(severity),\n    attackVector,\n    attackComplexity,\n    privilegesRequired,\n    userInteraction,\n    cwes,\n    references,\n    hasExploit,\n    published: cve.published,\n    lastModified: cve.lastModified,\n  };\n}\n\nexport function sortBySeverity(cves: FormattedCVE[]): FormattedCVE[] {\n  return [...cves].sort(\n    (a, b) =>\n      (SEVERITY_ORDER[a.severity] ?? 4) - (SEVERITY_ORDER[b.severity] ?? 4)\n  );\n}\n\nexport function getSummary(\n  cves: FormattedCVE[],\n  totalResults: number\n): SearchSummary {\n  return {\n    total: totalResults,\n    shown: cves.length,\n    critical: cves.filter((c) => c.severity === 'CRITICAL').length,\n    high: cves.filter((c) => c.severity === 'HIGH').length,\n    withExploit: cves.filter((c) => c.hasExploit).length,\n  };\n}\n\nexport function formatTextReport(\n  cves: FormattedCVE[],\n  summary: SearchSummary\n): string {\n  const lines: string[] = [];\n\n  lines.push('# CVE Search Results\\n');\n  lines.push(`Found ${summary.total} total results (showing ${summary.shown})\\n`);\n\n  for (const cve of cves) {\n    lines.push(formatSingleCVE(cve));\n  }\n\n  // Summary section\n  lines.push('\\n## Summary');\n  lines.push(`- Critical: ${summary.critical}`);\n  lines.push(`- High: ${summary.high}`);\n  lines.push(`- With known exploits: ${summary.withExploit}`);\n\n  if (\n    summary.critical > 0 ||\n    (summary.high > 0 && summary.withExploit > 0)\n  ) {\n    lines.push('\\nHigh bounty potential detected!');\n  }\n\n  return lines.join('\\n');\n}\n\nfunction formatSingleCVE(cve: FormattedCVE): string {\n  const lines: string[] = [];\n\n  lines.push(`\\n### ${cve.id}`);\n  lines.push('');\n  lines.push(`**Severity**: ${cve.severity} (${cve.score})`);\n  lines.push(`**Bounty Estimate**: ${cve.bountyEstimate}`);\n  lines.push('');\n  lines.push('**Description**:');\n  lines.push(cve.description);\n  lines.push('');\n  lines.push('**Attack Vector**:');\n  lines.push(`- Vector: ${cve.attackVector}`);\n  lines.push(`- Complexity: ${cve.attackComplexity}`);\n  lines.push(`- Privileges Required: ${cve.privilegesRequired}`);\n  lines.push(`- User Interaction: ${cve.userInteraction}`);\n  lines.push('');\n  lines.push(`**CWE**: ${cve.cwes.length > 0 ? cve.cwes.join(', ') : 'Not specified'}`);\n  lines.push('');\n  lines.push(`**Exploit Available**: ${cve.hasExploit ? 'Yes' : 'Unknown'}`);\n  lines.push('');\n  lines.push('**References**:');\n  for (const ref of cve.references) {\n    lines.push(`- ${ref}`);\n  }\n  lines.push('');\n  lines.push(`**Published**: ${new Date(cve.published).toLocaleDateString()}`);\n  lines.push('---');\n\n  return lines.join('\\n');\n}\n","#!/usr/bin/env node\n/**\n * CVE Search - NVD API 2.0 Client\n *\n * Searches the National Vulnerability Database for CVEs.\n * Rate limit: 5 requests/30s (public), 50 requests/30s (with API key)\n */\n\nimport { parseArgs, validateOptions } from './cli.js';\nimport { NVDClient } from './api.js';\nimport { formatCVE, sortBySeverity, getSummary, formatTextReport } from './formatter.js';\n\nasync function main(): Promise<void> {\n  const args = process.argv.slice(2);\n\n  if (args.length === 0 || args.includes('--help') || args.includes('-h')) {\n    parseArgs(['--help']);\n    process.exit(0);\n  }\n\n  const options = parseArgs(args);\n  if (!options) {\n    process.exit(0);\n  }\n\n  const validationError = validateOptions(options);\n  if (validationError) {\n    console.error(`Error: ${validationError}`);\n    process.exit(1);\n  }\n\n  console.error('Searching NVD...');\n\n  try {\n    const client = new NVDClient(options.apiKey);\n    const result = await client.search(options);\n\n    if (!result.vulnerabilities || result.vulnerabilities.length === 0) {\n      console.log('No CVEs found matching your criteria.');\n      process.exit(0);\n    }\n\n    const cves = result.vulnerabilities.map(formatCVE);\n    const sortedCves = sortBySeverity(cves);\n    const summary = getSummary(sortedCves, result.totalResults);\n\n    if (options.json) {\n      console.log(\n        JSON.stringify(\n          {\n            summary,\n            vulnerabilities: sortedCves,\n          },\n          null,\n          2\n        )\n      );\n    } else {\n      console.log(formatTextReport(sortedCves, summary));\n    }\n\n    // Exit with non-zero if critical vulnerabilities found\n    if (summary.critical > 0) {\n      process.exit(1);\n    }\n  } catch (error) {\n    console.error(`Error: ${error instanceof Error ? error.message : error}`);\n    process.exit(1);\n  }\n}\n\nmain();\n\n// Export for programmatic use\nexport { NVDClient } from './api.js';\nexport {\n  formatCVE,\n  sortBySeverity,\n  getSummary,\n  formatTextReport,\n} from './formatter.js';\nexport type {\n  CLIOptions,\n  FormattedCVE,\n  Severity,\n  SearchSummary,\n  NVDResponse,\n} from './types.js';\n"],"mappings":"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"}