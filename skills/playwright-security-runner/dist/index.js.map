{"version":3,"file":"index.js","names":["VALID_TEST_TYPES: TestType[]","args: string[]","options: TestOptions","url: string","PAYLOADS: PayloadCollection","BOUNTY_ESTIMATES: BountyEstimates","SQL_ERROR_PATTERNS: string[]","page: Page","formSelector: string | null","count","formSelector: string","inputs: InputInfo[]","inputSelector: string","payload: Payload","options: TestOptions","result: TestResult","results: TestResults","options: TestOptions","results: TestResults"],"sources":["../src/cli.ts","../src/payloads.ts","../src/runner.ts","../src/reporter.ts","../src/index.ts"],"sourcesContent":["/**\n * CLI argument parsing for Playwright Security Runner\n */\n\nimport type { TestOptions, TestType } from './types.js';\n\nconst VALID_TEST_TYPES: TestType[] = ['xss', 'sqli', 'auth', 'csrf', 'idor'];\n\nexport function parseArgs(args: string[]): TestOptions {\n  const options: TestOptions = {\n    url: '',\n    formSelector: null,\n    tests: ['xss', 'sqli'],\n    dryRun: false,\n    screenshot: false,\n    json: false,\n    headless: true,\n  };\n\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n\n    switch (arg) {\n      case '--url':\n      case '-u':\n        options.url = args[++i] || '';\n        break;\n      case '--form':\n      case '-f':\n        options.formSelector = args[++i] || null;\n        break;\n      case '--test':\n      case '-t': {\n        const testArg = args[++i] || '';\n        options.tests = testArg\n          .split(',')\n          .map((t) => t.trim() as TestType)\n          .filter((t) => VALID_TEST_TYPES.includes(t));\n        break;\n      }\n      case '--dry-run':\n        options.dryRun = true;\n        break;\n      case '--screenshot':\n        options.screenshot = true;\n        break;\n      case '--json':\n        options.json = true;\n        break;\n      case '--headed':\n        options.headless = false;\n        break;\n      case '--help':\n      case '-h':\n        printHelp();\n        process.exit(0);\n    }\n  }\n\n  return options;\n}\n\nexport function printHelp(): void {\n  console.log(`\nPlaywright Security Runner - Dynamic security testing\n\nWarning: This tool sends real payloads to targets.\nOnly use on systems you are authorized to test.\n\nUsage:\n  npx tsx src/index.ts --url <url> [options]\n\nOptions:\n  --url, -u <url>       Target URL (required)\n  --form, -f <selector> CSS selector for form\n  --test, -t <types>    Test types: xss,sqli,auth (default: xss,sqli)\n  --dry-run             Show plan without executing\n  --screenshot          Capture screenshots\n  --json                Output as JSON\n  --headed              Run with visible browser\n  --help, -h            Show this help\n\nExamples:\n  npx tsx src/index.ts --url \"http://localhost:3000\" --dry-run\n  npx tsx src/index.ts --url \"http://localhost:3000/login\" --test xss,sqli\n`);\n}\n\nexport function isProductionUrl(url: string): boolean {\n  const productionIndicators = [\n    /^https:\\/\\/(?!localhost)/,\n    /\\.(com|org|net|io|co|app)(?:\\/|$)/,\n    /^https:\\/\\/www\\./,\n    /^https:\\/\\/api\\./,\n  ];\n\n  return productionIndicators.some((pattern) => pattern.test(url));\n}\n\nexport function printProductionWarning(url: string): void {\n  console.log(`\nWARNING: Production URL Detected\n\nThe target URL appears to be a production system:\n${url}\n\nSecurity testing against production:\n- May cause service disruption\n- Could trigger security alerts\n- May violate terms of service\n\nEnsure you have explicit authorization to test this target.\n`);\n}\n","/**\n * Security test payloads for authorized penetration testing\n */\n\nimport type { PayloadCollection, BountyEstimates } from './types.js';\n\nexport const PAYLOADS: PayloadCollection = {\n  xss: [\n    { name: 'script-tag', value: '<script>alert(1)</script>' },\n    { name: 'img-onerror', value: '<img src=x onerror=alert(1)>' },\n    { name: 'svg-onload', value: '<svg onload=alert(1)>' },\n    { name: 'body-onload', value: '<body onload=alert(1)>' },\n    { name: 'quote-escape', value: '\\'\"><script>alert(1)</script>' },\n  ],\n  sqli: [\n    { name: 'or-true', value: \"' OR '1'='1\" },\n    { name: 'or-true-comment', value: \"' OR '1'='1'--\" },\n    { name: 'admin-bypass', value: \"admin'--\" },\n    { name: 'union-null', value: \"' UNION SELECT NULL--\" },\n    { name: 'sleep-test', value: \"' AND SLEEP(3)--\" },\n  ],\n  auth: [\n    { name: 'empty-password', value: '' },\n    { name: 'sql-bypass', value: \"' OR '1'='1\" },\n    { name: 'admin-guess', value: 'admin' },\n  ],\n};\n\nexport const BOUNTY_ESTIMATES: BountyEstimates = {\n  xss: '$500 - $10,000',\n  sqli: '$5,000 - $50,000',\n  csrf: '$1,000 - $10,000',\n  auth: '$10,000 - $50,000',\n  idor: '$2,000 - $50,000',\n};\n\nexport const SQL_ERROR_PATTERNS: string[] = [\n  'SQL syntax',\n  'mysql_',\n  'mysqli_',\n  'pg_',\n  'ORA-',\n  'SQLite',\n  'SQLSTATE',\n  'syntax error',\n  'unterminated',\n];\n","/**\n * Core security testing logic using Playwright\n */\n\nimport { chromium, type Page } from 'playwright';\nimport { mkdirSync, existsSync } from 'fs';\nimport { join, dirname } from 'path';\nimport { fileURLToPath } from 'url';\n\nimport type {\n  TestOptions,\n  TestResults,\n  TestResult,\n  FormInfo,\n  InputInfo,\n  Payload,\n} from './types.js';\nimport { PAYLOADS, SQL_ERROR_PATTERNS } from './payloads.js';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\nexport async function findForms(\n  page: Page,\n  formSelector: string | null\n): Promise<FormInfo[]> {\n  if (formSelector) {\n    const form = page.locator(formSelector);\n    const count = await form.count();\n    if (count > 0) {\n      return [{ selector: formSelector }];\n    }\n    return [];\n  }\n\n  const forms = page.locator('form');\n  const count = await forms.count();\n  return Array.from({ length: count }, (_, index) => ({\n    selector: `form:nth-of-type(${index + 1})`,\n  }));\n}\n\nexport async function getFormInputs(\n  page: Page,\n  formSelector: string\n): Promise<InputInfo[]> {\n  const inputs: InputInfo[] = [];\n\n  // Get text inputs and textareas\n  const inputLocator = page.locator(\n    `${formSelector} input:not([type=\"hidden\"]):not([type=\"submit\"]):not([type=\"button\"]), ${formSelector} textarea`\n  );\n  const count = await inputLocator.count();\n\n  for (let i = 0; i < count; i++) {\n    const el = inputLocator.nth(i);\n    const name = (await el.getAttribute('name')) || '';\n    const id = (await el.getAttribute('id')) || '';\n    const type = (await el.getAttribute('type')) || 'text';\n\n    inputs.push({\n      name: name || id || 'unnamed',\n      type,\n      selector: name ? `[name=\"${name}\"]` : id ? `#${id}` : `:nth-child(${i + 1})`,\n    });\n  }\n\n  return inputs;\n}\n\nexport async function testPayload(\n  page: Page,\n  formSelector: string,\n  inputSelector: string,\n  payload: Payload,\n  options: TestOptions\n): Promise<TestResult> {\n  const result: TestResult = {\n    payload: payload.value,\n    payloadName: payload.name,\n    field: inputSelector,\n    timestamp: new Date().toISOString(),\n    vulnerable: false,\n    evidence: [],\n  };\n\n  try {\n    await page.fill(`${formSelector} ${inputSelector}`, payload.value);\n\n    await Promise.all([\n      page.waitForLoadState('networkidle').catch(() => {}),\n      page\n        .click(\n          `${formSelector} [type=\"submit\"], ${formSelector} button:not([type=\"button\"])`\n        )\n        .catch(() => page.press(`${formSelector} ${inputSelector}`, 'Enter')),\n    ]);\n\n    await page.waitForTimeout(500);\n\n    // Check for payload reflection\n    const content = await page.content();\n    if (content.includes(payload.value)) {\n      result.vulnerable = true;\n      result.evidence.push('Payload reflected in response without encoding');\n    }\n\n    // Check for JavaScript dialog (XSS detection)\n    const dialogPromise = page\n      .waitForEvent('dialog', { timeout: 1000 })\n      .catch(() => null);\n    const dialog = await dialogPromise;\n    if (dialog) {\n      result.vulnerable = true;\n      result.evidence.push(`Alert dialog triggered: \"${dialog.message()}\"`);\n      await dialog.dismiss();\n    }\n\n    // Check for SQL error patterns\n    for (const error of SQL_ERROR_PATTERNS) {\n      if (content.toLowerCase().includes(error.toLowerCase())) {\n        result.vulnerable = true;\n        result.evidence.push(`SQL error detected: \"${error}\"`);\n      }\n    }\n\n    // Take screenshot if vulnerability found\n    if (options.screenshot && result.vulnerable) {\n      const screenshotDir = join(__dirname, '..', 'screenshots');\n      if (!existsSync(screenshotDir)) {\n        mkdirSync(screenshotDir, { recursive: true });\n      }\n      const screenshotPath = join(\n        screenshotDir,\n        `${payload.name}-${Date.now()}.png`\n      );\n      await page.screenshot({ path: screenshotPath });\n      result.screenshot = screenshotPath;\n    }\n  } catch (error) {\n    result.error = error instanceof Error ? error.message : String(error);\n  }\n\n  return result;\n}\n\nexport async function runTests(options: TestOptions): Promise<TestResults> {\n  const results: TestResults = {\n    target: options.url,\n    timestamp: new Date().toISOString(),\n    tests: [],\n    summary: { total: 0, vulnerable: 0 },\n  };\n\n  const browser = await chromium.launch({ headless: options.headless });\n  const context = await browser.newContext();\n  const page = await context.newPage();\n\n  try {\n    await page.goto(options.url, { waitUntil: 'networkidle' });\n\n    const forms = await findForms(page, options.formSelector);\n\n    if (forms.length === 0) {\n      console.log('No forms found on page');\n      return results;\n    }\n\n    for (const form of forms) {\n      const inputs = await getFormInputs(page, form.selector);\n\n      for (const input of inputs) {\n        for (const testType of options.tests) {\n          const payloads = PAYLOADS[testType] || [];\n\n          for (const payload of payloads) {\n            // Navigate back to initial state\n            await page.goto(options.url, { waitUntil: 'networkidle' });\n\n            const result = await testPayload(\n              page,\n              form.selector,\n              input.selector,\n              payload,\n              options\n            );\n            result.testType = testType;\n            result.form = form.selector;\n\n            results.tests.push(result);\n            results.summary.total++;\n\n            if (result.vulnerable) {\n              results.summary.vulnerable++;\n            }\n\n            // Rate limiting\n            await page.waitForTimeout(200);\n          }\n        }\n      }\n    }\n  } finally {\n    await browser.close();\n  }\n\n  return results;\n}\n","/**\n * Result reporting for security tests\n */\n\nimport type { TestOptions, TestResults, TestType } from './types.js';\nimport { PAYLOADS, BOUNTY_ESTIMATES } from './payloads.js';\n\nexport function printDryRun(options: TestOptions): void {\n  console.log(`\nDRY RUN MODE\n\nTarget: ${options.url}\nForm: ${options.formSelector || 'All forms'}\nTests: ${options.tests.join(', ')}\n\nPayloads that would be sent:\n`);\n\n  for (const testType of options.tests) {\n    const payloads = PAYLOADS[testType] || [];\n    console.log(\n      `\\n[${testType.toUpperCase()}] - Bounty: ${BOUNTY_ESTIMATES[testType]}`\n    );\n    payloads.forEach((p, i) => {\n      console.log(`  ${i + 1}. ${p.name}: ${p.value.substring(0, 50)}...`);\n    });\n  }\n\n  console.log(`\\nNo requests sent. Remove --dry-run to execute tests.\\n`);\n}\n\nexport function printResults(results: TestResults): void {\n  console.log(`\n# Security Test Results\n\n**Target**: ${results.target}\n**Timestamp**: ${results.timestamp}\n\n## Summary\n- Total tests: ${results.summary.total}\n- Vulnerabilities found: ${results.summary.vulnerable}\n`);\n\n  const vulnerabilities = results.tests.filter((t) => t.vulnerable);\n\n  if (vulnerabilities.length > 0) {\n    console.log(`## Vulnerabilities Found\\n`);\n\n    vulnerabilities.forEach((vuln, index) => {\n      const testType = vuln.testType as TestType;\n      console.log(\n        `### ${index + 1}. ${testType.toUpperCase()} - ${vuln.payloadName}`\n      );\n      console.log(`**Severity**: HIGH`);\n      console.log(`**Bounty Estimate**: ${BOUNTY_ESTIMATES[testType]}`);\n      console.log(`**Form**: ${vuln.form}`);\n      console.log(`**Field**: ${vuln.field}`);\n      console.log(`**Payload**: \\`${vuln.payload}\\``);\n      console.log(`\\n**Evidence**:`);\n      vuln.evidence.forEach((e) => console.log(`- ${e}`));\n      if (vuln.screenshot) {\n        console.log(`\\n**Screenshot**: ${vuln.screenshot}`);\n      }\n      console.log(`\\n---\\n`);\n    });\n  } else {\n    console.log(`## No Vulnerabilities Found\\n`);\n    console.log(\n      `All ${results.summary.total} tests passed without detecting vulnerabilities.`\n    );\n  }\n}\n","#!/usr/bin/env node\n\n/**\n * Playwright Security Runner\n *\n * Dynamic security testing of web forms.\n * Warning: This script sends real payloads - use responsibly.\n * Only use on systems you are authorized to test.\n */\n\nimport {\n  parseArgs,\n  printHelp,\n  isProductionUrl,\n  printProductionWarning,\n} from './cli.js';\nimport { runTests } from './runner.js';\nimport { printDryRun, printResults } from './reporter.js';\n\nasync function main(): Promise<void> {\n  const args = process.argv.slice(2);\n\n  if (args.length === 0) {\n    printHelp();\n    process.exit(0);\n  }\n\n  const options = parseArgs(args);\n\n  if (!options.url) {\n    console.error('Error: --url is required');\n    process.exit(1);\n  }\n\n  if (isProductionUrl(options.url) && !options.dryRun) {\n    printProductionWarning(options.url);\n  }\n\n  if (options.dryRun) {\n    printDryRun(options);\n    process.exit(0);\n  }\n\n  console.log(`\\nStarting security tests against: ${options.url}\\n`);\n\n  try {\n    const results = await runTests(options);\n\n    if (options.json) {\n      console.log(JSON.stringify(results, null, 2));\n    } else {\n      printResults(results);\n    }\n\n    if (results.summary.vulnerable > 0) {\n      process.exit(1);\n    }\n  } catch (error) {\n    console.error(\n      `Error: ${error instanceof Error ? error.message : String(error)}`\n    );\n    process.exit(1);\n  }\n}\n\nmain();\n"],"mappings":"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"}