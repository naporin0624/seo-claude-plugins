{"version":3,"file":"index.js","names":["severity: string","dockerfile: string","verbose: boolean","data: Buffer","image: string","findings: HadolintFinding[]","transformed: DockerfileFinding[]","trivyResult: TrivyImageResult","findings: ImageFinding[]","cvss: number | undefined","result: DockerfileScanResult","result: ImageScanResult"],"sources":["../src/index.ts"],"sourcesContent":["#!/usr/bin/env node\n\nimport { spawn, spawnSync } from \"node:child_process\";\nimport { parseArgs } from \"node:util\";\nimport type {\n  DockerfileFinding,\n  DockerfileScanResult,\n  HadolintFinding,\n  ImageFinding,\n  ImageScanResult,\n  TrivyImageResult,\n} from \"./types.js\";\n\nfunction checkHadolintInstalled(): boolean {\n  try {\n    const result = spawnSync(\"hadolint\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    return result.status === 0;\n  } catch {\n    return false;\n  }\n}\n\nfunction checkTrivyInstalled(): boolean {\n  try {\n    const result = spawnSync(\"trivy\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    return result.status === 0;\n  } catch {\n    return false;\n  }\n}\n\nfunction getHadolintVersion(): string {\n  try {\n    const result = spawnSync(\"hadolint\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    const match = result.stdout?.match(/Haskell Dockerfile Linter (\\S+)/);\n    return match?.[1] || \"unknown\";\n  } catch {\n    return \"unknown\";\n  }\n}\n\nfunction getTrivyVersion(): string {\n  try {\n    const result = spawnSync(\"trivy\", [\"--version\"], {\n      encoding: \"utf-8\",\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n    const match = result.stdout?.match(/Version:\\s*(\\S+)/);\n    return match?.[1] || \"unknown\";\n  } catch {\n    return \"unknown\";\n  }\n}\n\nfunction mapTrivySeverity(\n  severity: string\n): \"critical\" | \"high\" | \"medium\" | \"low\" | \"info\" {\n  switch (severity.toUpperCase()) {\n    case \"CRITICAL\":\n      return \"critical\";\n    case \"HIGH\":\n      return \"high\";\n    case \"MEDIUM\":\n      return \"medium\";\n    case \"LOW\":\n      return \"low\";\n    default:\n      return \"info\";\n  }\n}\n\nasync function runHadolint(\n  dockerfile: string,\n  verbose: boolean\n): Promise<HadolintFinding[]> {\n  return new Promise((resolve, reject) => {\n    const args = [\"-f\", \"json\", dockerfile];\n\n    if (verbose) {\n      console.error(`Running: hadolint ${args.join(\" \")}`);\n    }\n\n    const proc = spawn(\"hadolint\", args, {\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n\n    let stdout = \"\";\n    let stderr = \"\";\n\n    proc.stdout.on(\"data\", (data: Buffer) => {\n      stdout += data.toString();\n    });\n\n    proc.stderr.on(\"data\", (data: Buffer) => {\n      stderr += data.toString();\n    });\n\n    proc.on(\"close\", (code) => {\n      // hadolint exits with non-zero when issues found\n      try {\n        if (stdout.trim()) {\n          const result = JSON.parse(stdout) as HadolintFinding[];\n          resolve(result);\n        } else {\n          resolve([]);\n        }\n      } catch (e) {\n        reject(new Error(`Failed to parse hadolint output: ${e}\\n${stderr}`));\n      }\n    });\n\n    proc.on(\"error\", (err) => {\n      reject(new Error(`Failed to spawn hadolint: ${err.message}`));\n    });\n  });\n}\n\nasync function runTrivyImage(\n  image: string,\n  verbose: boolean\n): Promise<TrivyImageResult> {\n  return new Promise((resolve, reject) => {\n    const args = [\"image\", \"--format\", \"json\", \"--scanners\", \"vuln\", image];\n\n    if (verbose) {\n      console.error(`Running: trivy ${args.join(\" \")}`);\n    }\n\n    const proc = spawn(\"trivy\", args, {\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n    });\n\n    let stdout = \"\";\n    let stderr = \"\";\n\n    proc.stdout.on(\"data\", (data: Buffer) => {\n      stdout += data.toString();\n    });\n\n    proc.stderr.on(\"data\", (data: Buffer) => {\n      stderr += data.toString();\n    });\n\n    proc.on(\"close\", (code) => {\n      if (code === 0) {\n        try {\n          const result = JSON.parse(stdout) as TrivyImageResult;\n          resolve(result);\n        } catch (e) {\n          reject(new Error(`Failed to parse trivy output: ${e}`));\n        }\n      } else {\n        reject(new Error(`Trivy exited with code ${code}: ${stderr}`));\n      }\n    });\n\n    proc.on(\"error\", (err) => {\n      reject(new Error(`Failed to spawn trivy: ${err.message}`));\n    });\n  });\n}\n\nfunction transformHadolintResult(\n  findings: HadolintFinding[],\n  dockerfile: string\n): DockerfileScanResult {\n  const transformed: DockerfileFinding[] = findings.map((f) => ({\n    id: f.code,\n    severity: f.level,\n    line: f.line,\n    message: f.message,\n    file: f.file,\n  }));\n\n  return {\n    tool: \"hadolint\",\n    version: getHadolintVersion(),\n    scanPath: dockerfile,\n    scanDate: new Date().toISOString(),\n    findings: transformed,\n    summary: {\n      total: findings.length,\n      error: findings.filter((f) => f.level === \"error\").length,\n      warning: findings.filter((f) => f.level === \"warning\").length,\n      info: findings.filter((f) => f.level === \"info\").length,\n      style: findings.filter((f) => f.level === \"style\").length,\n    },\n  };\n}\n\nfunction transformTrivyImageResult(\n  trivyResult: TrivyImageResult,\n  image: string\n): ImageScanResult {\n  const findings: ImageFinding[] = [];\n\n  for (const target of trivyResult.Results || []) {\n    for (const vuln of target.Vulnerabilities || []) {\n      let cvss: number | undefined;\n      if (vuln.CVSS) {\n        for (const source of Object.values(vuln.CVSS)) {\n          if (source.V3Score) {\n            cvss = source.V3Score;\n            break;\n          }\n        }\n      }\n\n      findings.push({\n        id: vuln.VulnerabilityID,\n        severity: mapTrivySeverity(vuln.Severity),\n        package: vuln.PkgName,\n        installedVersion: vuln.InstalledVersion,\n        fixedVersion: vuln.FixedVersion,\n        title: vuln.Title || vuln.VulnerabilityID,\n        description: vuln.Description,\n        cvss,\n        cwes: vuln.CweIDs || [],\n        layer: vuln.Layer?.DiffID,\n      });\n    }\n  }\n\n  return {\n    tool: \"trivy\",\n    version: getTrivyVersion(),\n    image,\n    scanDate: new Date().toISOString(),\n    os: trivyResult.Metadata?.OS\n      ? {\n          family: trivyResult.Metadata.OS.Family,\n          name: trivyResult.Metadata.OS.Name,\n        }\n      : undefined,\n    findings,\n    summary: {\n      total: findings.length,\n      critical: findings.filter((f) => f.severity === \"critical\").length,\n      high: findings.filter((f) => f.severity === \"high\").length,\n      medium: findings.filter((f) => f.severity === \"medium\").length,\n      low: findings.filter((f) => f.severity === \"low\").length,\n      info: findings.filter((f) => f.severity === \"info\").length,\n    },\n  };\n}\n\nfunction printDockerfileReport(result: DockerfileScanResult): void {\n  console.log(\"\\n=== Dockerfile Lint Report ===\\n\");\n  console.log(`Tool: ${result.tool} (${result.version})`);\n  console.log(`File: ${result.scanPath}`);\n  console.log(`Date: ${result.scanDate}`);\n  console.log(\"\\n--- Summary ---\");\n  console.log(`Total: ${result.summary.total}`);\n  console.log(`  Errors: ${result.summary.error}`);\n  console.log(`  Warnings: ${result.summary.warning}`);\n  console.log(`  Info: ${result.summary.info}`);\n  console.log(`  Style: ${result.summary.style}`);\n\n  if (result.findings.length > 0) {\n    console.log(\"\\n--- Issues ---\\n\");\n\n    const severityOrder = { error: 0, warning: 1, info: 2, style: 3 };\n    const sorted = [...result.findings].sort(\n      (a, b) => severityOrder[a.severity] - severityOrder[b.severity]\n    );\n\n    for (const finding of sorted) {\n      console.log(`[${finding.severity.toUpperCase()}] ${finding.id}`);\n      console.log(`  Line: ${finding.line}`);\n      console.log(`  Message: ${finding.message}`);\n      console.log(\"\");\n    }\n  } else {\n    console.log(\"\\nNo issues found.\");\n  }\n}\n\nfunction printImageReport(result: ImageScanResult): void {\n  console.log(\"\\n=== Container Image Scan Report ===\\n\");\n  console.log(`Tool: ${result.tool} (${result.version})`);\n  console.log(`Image: ${result.image}`);\n  if (result.os) {\n    console.log(`OS: ${result.os.family} ${result.os.name}`);\n  }\n  console.log(`Date: ${result.scanDate}`);\n  console.log(\"\\n--- Summary ---\");\n  console.log(`Total: ${result.summary.total}`);\n  console.log(`  Critical: ${result.summary.critical}`);\n  console.log(`  High: ${result.summary.high}`);\n  console.log(`  Medium: ${result.summary.medium}`);\n  console.log(`  Low: ${result.summary.low}`);\n  console.log(`  Info: ${result.summary.info}`);\n\n  if (result.findings.length > 0) {\n    console.log(\"\\n--- Vulnerabilities ---\\n\");\n\n    const severityOrder = { critical: 0, high: 1, medium: 2, low: 3, info: 4 };\n    const sorted = [...result.findings].sort(\n      (a, b) => severityOrder[a.severity] - severityOrder[b.severity]\n    );\n\n    for (const finding of sorted) {\n      console.log(`[${finding.severity.toUpperCase()}] ${finding.id}`);\n      console.log(`  Package: ${finding.package}@${finding.installedVersion}`);\n      if (finding.fixedVersion) {\n        console.log(`  Fixed in: ${finding.fixedVersion}`);\n      }\n      console.log(`  Title: ${finding.title}`);\n      if (finding.cvss) {\n        console.log(`  CVSS: ${finding.cvss}`);\n      }\n      console.log(\"\");\n    }\n  } else {\n    console.log(\"\\nNo vulnerabilities found.\");\n  }\n}\n\nfunction printHelp(): void {\n  console.log(`\ncontainer-scanner - Container and Dockerfile Security Scanner\n\nUsage:\n  container-scanner lint <dockerfile> [options]\n  container-scanner image <image-name> [options]\n  container-scanner --check\n\nCommands:\n  lint <dockerfile>    Lint a Dockerfile with Hadolint\n  image <image-name>   Scan container image with Trivy\n\nOptions:\n  --json, -j           Output as JSON\n  --verbose, -v        Verbose output\n  --check              Check available tools\n  --help, -h           Show this help\n\nExamples:\n  container-scanner lint Dockerfile\n  container-scanner lint Dockerfile --json\n  container-scanner image nginx:latest\n  container-scanner image myapp:v1 --json\n`);\n}\n\nasync function main(): Promise<void> {\n  const { values, positionals } = parseArgs({\n    allowPositionals: true,\n    options: {\n      json: { type: \"boolean\", short: \"j\", default: false },\n      verbose: { type: \"boolean\", short: \"v\", default: false },\n      check: { type: \"boolean\", default: false },\n      help: { type: \"boolean\", short: \"h\", default: false },\n    },\n  });\n\n  if (values.help) {\n    printHelp();\n    process.exit(0);\n  }\n\n  if (values.check) {\n    console.log(\"Available tools:\");\n    console.log(`  hadolint: ${checkHadolintInstalled() ? \"installed\" : \"not found\"}`);\n    console.log(`  trivy: ${checkTrivyInstalled() ? \"installed\" : \"not found\"}`);\n\n    if (!checkHadolintInstalled()) {\n      console.error(\"\\nInstall hadolint: brew install hadolint\");\n    }\n    if (!checkTrivyInstalled()) {\n      console.error(\"Install trivy: brew install trivy\");\n    }\n    process.exit(0);\n  }\n\n  const command = positionals[0];\n  const target = positionals[1];\n\n  if (!command || ![\"lint\", \"image\"].includes(command)) {\n    console.error(\"Error: Please specify a command (lint or image)\");\n    printHelp();\n    process.exit(2);\n  }\n\n  if (!target) {\n    console.error(`Error: Please specify a target for '${command}' command`);\n    process.exit(2);\n  }\n\n  try {\n    if (command === \"lint\") {\n      if (!checkHadolintInstalled()) {\n        console.error(\"Error: hadolint is not installed.\");\n        console.error(\"Install with: brew install hadolint\");\n        process.exit(2);\n      }\n\n      const findings = await runHadolint(target, values.verbose || false);\n      const result = transformHadolintResult(findings, target);\n\n      if (values.json) {\n        console.log(JSON.stringify(result, null, 2));\n      } else {\n        printDockerfileReport(result);\n      }\n\n      if (result.summary.total > 0) {\n        process.exit(1);\n      }\n    } else if (command === \"image\") {\n      if (!checkTrivyInstalled()) {\n        console.error(\"Error: trivy is not installed.\");\n        console.error(\"Install with: brew install trivy\");\n        process.exit(2);\n      }\n\n      const trivyResult = await runTrivyImage(target, values.verbose || false);\n      const result = transformTrivyImageResult(trivyResult, target);\n\n      if (values.json) {\n        console.log(JSON.stringify(result, null, 2));\n      } else {\n        printImageReport(result);\n      }\n\n      if (result.summary.total > 0) {\n        process.exit(1);\n      }\n    }\n\n    process.exit(0);\n  } catch (error) {\n    console.error(\n      `Error: ${error instanceof Error ? error.message : String(error)}`\n    );\n    process.exit(2);\n  }\n}\n\nmain();\n"],"mappings":"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"}